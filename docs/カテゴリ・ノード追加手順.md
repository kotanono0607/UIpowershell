# カテゴリ・ノード追加手順

新しいカテゴリやノードボタンを追加する手順を説明します。

---

## 1. 新しいカテゴリを追加する

### 編集ファイル
`カテゴリ設定.json`

### 手順
配列の末尾に新しいカテゴリオブジェクトを追加します。

```json
{
    "番号": 11,
    "名前": "TEST",
    "色": "rgb(255, 200, 200)",
    "説明": "【TEST】\nテスト用カテゴリです。\n\n・動的生成の動作確認用"
}
```

### フィールド説明

| フィールド | 説明 | 例 |
|------------|------|-----|
| 番号 | カテゴリの一意な番号（1から連番） | `11` |
| 名前 | カテゴリボタンに表示される名前 | `"TEST"` |
| 色 | カテゴリボタンの背景色（RGB形式） | `"rgb(255, 200, 200)"` |
| 説明 | マウスオーバー時に表示される説明文 | `"【TEST】\n説明文..."` |

---

## 2. 新しいノードボタンを追加する

### 編集ファイル
`ボタン設定.json`

### 手順
配列の末尾に新しいボタンオブジェクトを追加します。

```json
{
    "処理番号": "11-1",
    "テキスト": "テストノード",
    "ボタン名": "110",
    "背景色": "White",
    "コンテナ": "操作フレームパネル11",
    "説明": "TESTカテゴリの動作確認用ノードです。",
    "関数名": "11_1"
}
```

### フィールド説明

| フィールド | 説明 | 命名規則 |
|------------|------|----------|
| 処理番号 | 処理の識別番号 | `{カテゴリ番号}-{連番}` 例: `11-1` |
| テキスト | ボタンに表示されるテキスト | 任意 |
| ボタン名 | ボタンの内部名 | `{カテゴリ番号}{連番}` 例: `110` |
| 背景色 | ボタンの背景色 | `White`, `SpringGreen` など |
| コンテナ | 所属カテゴリパネル | `操作フレームパネル{カテゴリ番号}` |
| 説明 | ボタンの説明文 | 任意 |
| 関数名 | 呼び出す関数名 | `{カテゴリ番号}_{連番}` 例: `11_1` |

### パラメータ付きボタン（オプション）

ユーザー入力が必要なノードの場合：

```json
{
    "処理番号": "11-2",
    "テキスト": "パラメータ付きノード",
    "ボタン名": "111",
    "背景色": "White",
    "コンテナ": "操作フレームパネル11",
    "説明": "パラメータ付きノードの例",
    "関数名": "11_2",
    "パラメータ": [
        {
            "名前": "メッセージ",
            "型": "text",
            "プレースホルダー": "入力例",
            "必須": true
        }
    ]
}
```

#### パラメータの型

| 型 | 説明 |
|----|------|
| `text` | 1行テキスト入力 |
| `textarea` | 複数行テキスト入力（`行数`オプション指定可） |
| `number` | 数値入力（`最小値`/`最大値`オプション指定可） |

---

## 3. PowerShellスクリプトを作成する

### 作成ファイル
`00_code/{処理番号}.ps1`

例: `00_code/11-1.ps1`

### ファイル形式
- **文字コード**: UTF-8 BOM（必須）
- **関数名**: ボタン設定.jsonの`関数名`と一致させる

### テンプレート

```powershell

function 11_1 {
@"
Write-Host "TESTノード実行"
"@
}
```

### 構造説明

```powershell
function {関数名} {
@"
{生成されるPowerShellコード}
"@
}
```

- `@"` と `"@` で囲まれた部分がコード生成時に出力される
- ヒアストリング内では変数展開が可能（`$変数名`）

---

## 追加手順まとめ

| 手順 | ファイル | 作業内容 |
|------|----------|----------|
| 1 | `カテゴリ設定.json` | カテゴリ定義を追加 |
| 2 | `ボタン設定.json` | ノードボタン定義を追加 |
| 3 | `00_code/{処理番号}.ps1` | PowerShellスクリプトを作成 |

**注意**: アプリの再起動が必要です。
